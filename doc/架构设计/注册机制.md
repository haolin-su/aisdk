# 注册机制

## 注册中心
初始化的时候需要将各个模块进行注册，目前注册的模块包含算法和设备

### 模块编译
各个模块采用宏定义的方式进行编译，在编译的时候会将模块的名称、版本、依赖等信息进行注册到注册中心。
模块编译代码：
```
#define REGISTER_MODULE(name, version, deps) \
    static const char* module_name = name; \
    static const char* module_version = version; \
    static const char* module_deps[] = {deps}; \
    static const int module_deps_count = sizeof(module_deps) / sizeof(module_deps[0]); \
    static void module_register() { \
        /* register module */ \
    } \
    static void module_unregister() { \
        /* unregister module */ \
    } \
    __attribute__((constructor)) static void module_constructor() { \
        module_register(); \
    } \
    __attribute__((destructor)) static void module_destructor() { \
        module_unregister(); \
    }
```

cmake中也采用类似的方式进行模块的编译：
```cmake
```

### 模块初始化
在程序运行初始化需要进行模块的注册，将各个模块的初始化信息注册到注册中心，包括模块名称，模块版本，模块地址，模块依赖等信息。
```cpp
void init() {
    // register modules
    register_algorithm_module();
    register_device_module();
}
```


## 注册模块
### 算法模块注册
算法注册主要包含了算法的前后处理，包含通用的算法参数，算法的CPU通用处理



### 设备模块注册
针对具体算法的前后处理的硬件加速接口复写
针对硬件的模型解析和模型推理，内存/显存操作


